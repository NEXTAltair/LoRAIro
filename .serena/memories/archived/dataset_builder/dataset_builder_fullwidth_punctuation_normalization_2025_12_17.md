# 作業記録: TAGS.tag の全角記号（特に全角コロン）を半角へ正規化

## 日付
2025-12-17

## 背景
- タグ文字列の区切りとして全角コロン `：` を含むケースがあり、正規化後の `TAGS.tag` に混入すると扱いが悪い。
- 顔文字は例外として保持したい。

## 方針（ユーザー決定）
- 顔文字以外のタグで全角記号が混入している場合は修正する。
- 特に区切りコロンは半角コロン `:` に寄せる。

## 実装
- `src/genai_tag_db_dataset_builder/core/normalize.py` の `normalize_tag()` に全角→半角の置換（`str.translate`）を追加。
  - 対象: `：` を含む主要な全角句読点/記号、全角スペース
  - 顔文字は `is_kaomoji()` で除外されるため、顔文字への破壊的影響は避ける。

## 検証
- CC0再ビルド後、SQLite内の全角コロン混入は `instr(tag, char(65306)) > 0` で `0件` を確認。
