{
    "name": "LoRAIro Development Environment",
    "build": {
        "dockerfile": "Dockerfile",
        "args": {
            "TZ": "${localEnv:TZ:UTC}"
        }
    },
    "runArgs": [
        "--cap-add=SYS_PTRACE",
        "--security-opt",
        "seccomp=unconfined",
        "-p",
        "2222:22"
    ],
    // 複数の Devcontainer がある場合、プロジェクトごとにこのポート番号を変える
    "forwardPorts": [2222],
    "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces/LoRAIro,type=bind,consistency=delegated",
    "workspaceFolder": "/workspaces/LoRAIro",
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-python.mypy-type-checker",
                "charliermarsh.ruff",
                "njpwerner.autodocstring",
                "kawamataryo.copy-python-dotted-path",
                "seanwu.vscode-qt-for-python",
                "qwtel.sqlite-viewer",
                "tamasfe.even-better-toml",
                "mechatroner.rainbow-csv",
                "eamodio.gitlens",
                "donjayamanne.git-extension-pack",
                "codezombiech.gitignore",
                "streetsidesoftware.code-spell-checker",
                "vscode-icons-team.vscode-icons",
                "shardulm94.trailing-spaces",
                "gruntfuggly.todo-tree",
                "intellsmi.comment-translate",
                "cweijan.vscode-typora",
                "alexkrechik.cucumberautocomplete",
                "wscats.search",
                "rooveterinaryinc.roo-cline",
                "google.geminicodeassist",
                "esbenp.prettier-vscode",
                "ms-azuretools.vscode-docker",
                "masakit.zenkaku-hankaku"
            ]
        }
    },
    "overrideCommand":true,
    "remoteUser": "vscode",
    "remoteEnv": {
        "QT_QPA_PLATFORM": "offscreen",
        "DISPLAY": ":99",
        "CLAUDE_CONFIG_DIR": "/home/vscode/.claude"
    },
    "mounts": [
        "source=lorairo-bashhistory,target=/home/vscode/.bash_history,type=volume",
        "source=lorairo-vscode-extensions,target=/home/vscode/.vscode-server/extensions,type=volume",
        "source=lorairo-venv,target=/workspaces/LoRAIro/.venv,type=volume",
        "source=lorairo-claude-config,target=/home/vscode/.claude,type=volume"
    ],
    "postCreateCommand": "bash .devcontainer/postCreateCommand.sh",
    "postAttachCommand": {
        "mcpSerena": "claude mcp add serena -- uvx --from git+https://github.com/oraios/serena serena start-mcp-server --context ide-assistant --project /workspaces/LoRAIro"
    },
    "features": {
        "ghcr.io/devcontainers/features/sshd:1": {
        "version": "latest",
        "ports": "22",
        "passwordAccess": "disabled"
        },
        "ghcr.io/devcontainers/features/node:1": {
        "version": "20",
        "installYarnUsingApt": false
        }
    }
}
