{
    "name": "LoRAIro Development Environment",
    "build": {
        "dockerfile": "Dockerfile",
        "args": {
            "TZ": "${localEnv:TZ:UTC}"
        }
    },
    "runArgs": [
        "--cap-add=SYS_PTRACE",
        "--security-opt",
        "seccomp=unconfined"
    ],
    "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces/LoRAIro,type=bind,consistency=delegated",
    "workspaceFolder": "/workspaces/LoRAIro",
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-python.mypy-type-checker",
                "charliermarsh.ruff",
                "njpwerner.autodocstring",
                "kawamataryo.copy-python-dotted-path",
                "seanwu.vscode-qt-for-python",
                "qwtel.sqlite-viewer",
                "tamasfe.even-better-toml",
                "mechatroner.rainbow-csv",
                "eamodio.gitlens",
                "donjayamanne.git-extension-pack",
                "codezombiech.gitignore",
                "streetsidesoftware.code-spell-checker",
                "vscode-icons-team.vscode-icons",
                "shardulm94.trailing-spaces",
                "gruntfuggly.todo-tree",
                "intellsmi.comment-translate",
                "cweijan.vscode-typora",
                "alexkrechik.cucumberautocomplete",
                "wscats.search",
                "rooveterinaryinc.roo-cline",
                "google.geminicodeassist",
                "esbenp.prettier-vscode",
                "ms-azuretools.vscode-docker",
                "masakit.zenkaku-hankaku"
            ],
            "settings": {
                "python.defaultInterpreterPath": "/workspaces/LoRAIro/.venv_linux/bin/python",
                "python.analysis.extraPaths": [
                "./src",
                "./local_packages/genai-tag-db-tools/src",
                "./local_packages/image-annotator-lib/src"
                ],
                "[python]": {
                    "editor.defaultFormatter": "charliermarsh.ruff",
                    "editor.formatOnSave": true,
                    "editor.codeActionsOnSave": {
                        "source.fixAll": "explicit",
                        "source.organizeImports": "explicit"
                    }
                },
                "python.testing.pytestEnabled": true,
                "python.analysis.autoImportCompletions": true,
                "python.analysis.typeCheckingMode": "strict",
                "python.linting.enabled": true,
                "python.linting.pylintEnabled": false,
                "python.linting.mypyEnabled": true,
                "files.exclude": {
                    "**/__pycache__": true,
                    "**/*.pyc": true,
                    "**/.pytest_cache": true,
                    "**/.mypy_cache": true,
                    "**/.ruff_cache": true
                },
                "terminal.integrated.defaultProfile.linux": "bash",
                "terminal.integrated.profiles.linux": {
                    "bash": {
                        "path": "bash",
                        "icon": "terminal-bash"
                    }
                }
            }
        }
    },
    "remoteUser": "vscode",
    "remoteEnv": {
        "UV_PROJECT_ENVIRONMENT": ".venv_linux",
        "QT_QPA_PLATFORM": "offscreen",
        "DISPLAY": ":99"
    },
    "postCreateCommand": [
        "bash -lc 'set -euo pipefail; cd /workspaces/LoRAIro; make install-dev'",
        "bash -lc \"claude mcp add context7 -s project -- npx -y @upstash/context7-mcp\"",
        "bash -lc \"claude mcp add serena -- uvx --from git+https://github.com/oraios/serena serena start-mcp-server --context ide-assistant --project $(pwd)\"",
        "bash -lc \"claude mcp add playwright -s project -- npx -y @playwright/mcp@latest\""
    ],
    "postStartCommand": "bash -lc 'echo UV_PROJECT_ENVIRONMENT=$UV_PROJECT_ENVIRONMENT; ls -ld .venv_linux || true; chmod +x .claude/hooks/*.sh || true'",
     "mounts": [
        "source=lorairo-bashhistory-${devcontainerId},target=/home/vscode/.bash_history,type=volume",
        "source=lorairo-vscode-extensions-${devcontainerId},target=/home/vscode/.vscode-server/extensions,type=volume"
    ],
    "features": {
        "ghcr.io/devcontainers/features/git:1": {
            "ppa": true,
            "version": "latest"
        }
    }
}
