{
  "documentation_first_commands": [
    {
      "pattern": "^(find|grep|rg|ls)\\b.*\\.(py|toml|md)$",
      "reason": "use serena でプロジェクト構造と関連ドキュメントを参照してから検索を行う",
      "suggestion": "use serena を実行してコンポーネント位置のコンテキストを取得した後に必要なら検索する"
    },
    {
      "pattern": "^(find|grep|rg)\\b.*\\bsrc/",
      "reason": "src/配下を検索する前に use serena でコンポーネント位置のコンテキストを確認する",
      "suggestion": "use serena: Entry point (src/lorairo/main.py), Services (src/lorairo/services/), GUI (src/lorairo/gui/), Database (src/lorairo/database/), AI Integration (src/lorairo/annotations/)"
    },
    {
      "pattern": "^(find|grep|rg)\\b.*\\bconfig/",
      "reason": "設定構成の確認は use serena で関連情報を参照する",
      "suggestion": "use serena: config/lorairo.toml (main config), config/annotator_config.toml (AI settings)"
    }
  ],
  "library_investigation_suggestions": [
    {
      "pattern": "(ImportError|ModuleNotFoundError|No module named)",
      "reason": "Library import error detected",
      "suggestion": "Use SubAgent library-research to investigate library installation, documentation, and usage patterns"
    },
    {
      "pattern": "(AttributeError.*module|TypeError.*library|API.*error)",
      "reason": "Library API usage error detected",
      "suggestion": "Use SubAgent library-research to check library specifications, API changes, and implementation examples"
    },
    {
      "pattern": "(site-packages|lib/python|dist-info)",
      "reason": "Direct library investigation detected",
      "suggestion": "Consider using SubAgent library-research for comprehensive library analysis instead of manual exploration"
    }
  ],
  "blocked_commands": [
    {
      "pattern": "^pip ",
      "reason": "Use 'uv' instead of pip in this project",
      "suggestion": "uv add <package>"
    },
    {
      "pattern": "^npm ",
      "reason": "This is a Python project, npm should not be used",
      "suggestion": "Use uv for Python package management"
    },
    {
      "pattern": "^curl.*api\\.openai\\.com",
      "reason": "Direct API calls should go through the image-annotator-lib",
      "suggestion": "Use src/lorairo/annotations/ai_annotator.py for AI integration"
    },
    {
      "pattern": "^git push.*origin.*main",
      "reason": "Direct push to main branch is restricted",
      "suggestion": "Create feature branch and use pull request"
    },
    {
      "pattern": "^rm\\s+-rf\\s+.+",
      "reason": "Destructive operations require explicit user confirmation",
      "suggestion": "Confirm with the user before running rm -rf. Prefer safe tasks like: make clean, or remove only approved paths: logs/, __pycache__, .pytest_cache, .ruff_cache"
    }
  ],
  "auto_format_commands": [
    {
      "pattern": "^git add.*\\.(py)$",
      "pre_hook": "uv run ruff check --fix $FILES && uv run ruff format $FILES",
      "description": "Auto-format and fix Python files before staging"
    },
    {
      "pattern": "^git commit",
      "pre_hook": "uv run ruff format src/ tests/ && uv run ruff check src/ tests/ --fix",
      "description": "Auto-format all code before git commit"
    }
  ],
  "lorairo_environment_transforms": [
    {
      "pattern": "^pytest",
      "transform": "s/^pytest/uv run pytest/",
      "description": "Transform pytest commands to use LoRAIro Linux environment"
    },
    {
      "pattern": "^ruff\\s+(check|format)",
      "transform": "s/^ruff/uv run ruff/",
      "description": "Transform ruff commands to use LoRAIro Linux environment"
    },
    {
      "pattern": "^mypy",
      "transform": "s/^mypy/uv run mypy/",
      "description": "Transform mypy commands to use LoRAIro Linux environment"
    },
    {
      "pattern": "^python\\s+",
      "transform": "s/^python/uv run python/",
      "description": "Transform python commands to use LoRAIro Linux environment"
    }
  ],
  "description": "LoRAIroプロジェクト用コマンド制御 - use serena 優先検索・自動フォーマット・危険コマンドブロック。ライブラリ調査は SubAgent library-research を推奨。"
}
